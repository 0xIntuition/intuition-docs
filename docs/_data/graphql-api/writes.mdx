---
id: writes
title: Writes
sidebar_label: Writes
sidebar_position: 3
description: Guide to write data using GraphQL mutations in the Intuition API
---

# Writes

## GraphQL Mutations

Our GraphQL API provides mutations for preparing metadata and accessing analytics services. These mutations help you structure and publish data to IPFS, generate charts, and retrieve PnL analytics.

:::info Smart Contract Operations
Creating atoms, triples, and taking positions are **smart contract operations** performed via the [Intuition SDK](/docs/intuition-sdk/overview) or direct contract calls. The GraphQL mutations below help prepare metadata (IPFS pinning) and provide analytics services. They do not modify blockchain state directly.
:::

## Available Mutations

### Metadata Pinning

Upload structured metadata to IPFS for use when creating atoms on-chain:

| Mutation | Description | Details |
|----------|-------------|---------|
| `pinThing` | Pin generic entity metadata | [Documentation](/docs/graphql-api/mutations/pin-thing) |
| `pinPerson` | Pin person metadata | [Documentation](/docs/graphql-api/mutations/pin-person) |
| `pinOrganization` | Pin organization metadata | [Documentation](/docs/graphql-api/mutations/pin-organization) |

### Image & Data Upload

| Mutation | Description | Details |
|----------|-------------|---------|
| `uploadImage` | Upload base64-encoded image | [Documentation](/docs/graphql-api/mutations/image-upload) |
| `uploadImageFromUrl` | Upload image from URL | [Documentation](/docs/graphql-api/mutations/image-upload) |
| `uploadJsonToIpfs` | Upload custom JSON to IPFS | [Documentation](/docs/graphql-api/mutations/image-upload) |

### Charts & Visualization

| Mutation | Description | Details |
|----------|-------------|---------|
| `getChartJson` | Get share price chart data (JSON) | [Documentation](/docs/graphql-api/mutations/charts) |
| `getChartSvg` | Get share price chart (SVG) | [Documentation](/docs/graphql-api/mutations/charts) |
| `getChartRawJson` | Get raw chart data (JSON) | [Documentation](/docs/graphql-api/mutations/charts) |
| `getChartRawSvg` | Get raw chart (SVG) | [Documentation](/docs/graphql-api/mutations/charts) |

### PnL Analytics

| Mutation | Description | Details |
|----------|-------------|---------|
| `getAccountPnlCurrent` | Get current account PnL snapshot | [Documentation](/docs/graphql-api/mutations/pnl) |
| `getAccountPnlChart` | Get account PnL chart data | [Documentation](/docs/graphql-api/mutations/pnl) |
| `getAccountPnlRealized` | Get realized PnL breakdown | [Documentation](/docs/graphql-api/mutations/pnl) |
| `getPositionPnlChart` | Get position PnL chart data | [Documentation](/docs/graphql-api/mutations/pnl) |

## Metadata Pinning

The primary mutations for metadata are the pin mutations which upload structured data to IPFS following schema.org patterns.

### pinThing Mutation

```graphql
mutation PinThing($thing: PinThingInput!) {
  pinThing(thing: $thing) {
    hash
    name
    size
  }
}
```

### Variables

```json
{
  "thing": {
    "name": "Intuition Protocol",
    "description": "A decentralized trust protocol for the internet",
    "image": "https://intuition.systems/logo.png",
    "url": "https://intuition.systems"
  }
}
```

### Response

```json
{
  "data": {
    "pinThing": {
      "hash": "QmYx8C3kNN1sFSx5b...",
      "name": "thing.json",
      "size": 256
    }
  }
}
```

The returned hash can be used to construct an IPFS URI (`ipfs://QmYx8C3kNN1sFSx5b...`) for atom creation via the SDK.

## Complete Workflow

Here's how to create an atom with metadata using both GraphQL mutations and the SDK:

```typescript
import { GraphQLClient } from 'graphql-request'
import { IntuitonClient } from '@0xintuition/sdk'

const graphqlClient = new GraphQLClient('https://mainnet.intuition.sh/v1/graphql')
const intuition = new IntuitionClient({ ... })

async function createAtomWithMetadata() {
  // 1. Pin metadata to IPFS using GraphQL mutation
  const pinMutation = `
    mutation PinThing($thing: PinThingInput!) {
      pinThing(thing: $thing) {
        hash
      }
    }
  `

  const { pinThing } = await graphqlClient.request(pinMutation, {
    thing: {
      name: 'My Project',
      description: 'A description of my project',
      image: 'https://example.com/image.png',
      url: 'https://example.com'
    }
  })

  const ipfsUri = `ipfs://${pinThing.hash}`

  // 2. Create atom on-chain using SDK
  const atomId = await intuition.createAtom(ipfsUri)

  console.log('Atom created:', atomId)
  return atomId
}
```

## PnL Analytics

Get profit and loss data for accounts and positions:

```typescript
import { GraphQLClient } from 'graphql-request'

const client = new GraphQLClient('https://mainnet.intuition.sh/v1/graphql')

async function getAccountPnl(accountId: string) {
  const mutation = `
    mutation GetAccountPnlCurrent($input: GetAccountPnlCurrentInput!) {
      getAccountPnlCurrent(input: $input) {
        total_value
        total_cost
        unrealized_pnl
        unrealized_pnl_percentage
        realized_pnl
        total_pnl
        total_pnl_percentage
      }
    }
  `

  return client.request(mutation, {
    input: { account_id: accountId }
  })
}
```

## Chart Generation

Generate share price charts as SVG or JSON data:

```typescript
async function getSharePriceChart(termId: string, curveId: string) {
  const mutation = `
    mutation GetChartSvg($input: GetChartSvgInput!) {
      getChartSvg(input: $input) {
        svg
      }
    }
  `

  return client.request(mutation, {
    input: {
      term_id: termId,
      curve_id: curveId,
      interval: '1d',
      width: 600,
      height: 300,
      line_color: '#10B981'
    }
  })
}
```

## Best Practices

### Complete Metadata
Provide as much relevant metadata as possible to improve the Atom's utility across different contexts.

### Persistent Storage
All metadata is stored on IPFS, ensuring data availability and immutability.

### URI Standards
Use standard URI formats:
- **IPFS**: `ipfs://Qm...`
- **HTTP(S)**: `https://...`

### Error Handling
Always handle potential errors:

```typescript
try {
  const { pinThing } = await client.request(pinMutation, variables)
  const ipfsUri = `ipfs://${pinThing.hash}`
  // Use URI with SDK to create atom
} catch (error) {
  console.error('Failed to pin metadata:', error.message)
}
```

## TypeScript Integration

We maintain a `@0xintuition/graphql` package that auto-generates TypeScript types and React hooks for all mutations:

```typescript
import { usePinThingMutation } from '@0xintuition/graphql'

function CreateAtomComponent() {
  const [pinThing, { loading }] = usePinThingMutation()

  const handlePin = async (thingData: ThingData) => {
    const { data } = await pinThing({
      variables: { thing: thingData }
    })

    const ipfsUri = `ipfs://${data?.pinThing?.hash}`
    // Use with SDK to create atom on-chain
  }

  return (
    <button onClick={() => handlePin(thingData)} disabled={loading}>
      {loading ? 'Pinning...' : 'Pin Metadata'}
    </button>
  )
}
```

## Related Resources

- [Pin Thing Mutation](/docs/graphql-api/mutations/pin-thing) - Detailed pin documentation
- [Charts Mutations](/docs/graphql-api/mutations/charts) - Chart generation
- [PnL Mutations](/docs/graphql-api/mutations/pnl) - Profit & loss analytics
- [Image Upload](/docs/graphql-api/mutations/image-upload) - Image handling
- [SDK Overview](/docs/intuition-sdk/overview) - On-chain operations
- [GraphQL Package Source](https://github.com/0xIntuition/intuition-ts/tree/main/packages/graphql)
